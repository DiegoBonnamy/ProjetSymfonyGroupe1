{% extends 'base.html.twig' %}

{% block title %}New Sortie{% endblock %}

{% block body %}
    <div class="text-center symfony-form">
        <h1>Créer une sortie</h1>

        {{ form_start(form) }}

        <!-- Formulaire -->
        <div class="row">
            <!-- Col 1 -->
            <div class="col">

                <label>Nom de la sortie : </label>
                {{ form_widget(form.nom) }} <br/>

                <label>Date de la sortie : </label>
                {{ form_widget(form.dateDebut) }} <br/>

                <label>Date limite d'inscription : </label>
                {{ form_widget(form.dateCloture) }} <br/>

                <label>Nombre de places : </label>
                {{ form_widget(form.nbInscriptionsMax) }} <br/>

                <label>Durée : </label>
                {{ form_widget(form.duree) }} <br/>

                <label>Image mis en avant : </label>
                {{ form_widget(form.urlPhoto) }} <br/>

                <label>Description et infos : </label>
                {{ form_widget(form.descriptionInfos) }} <br/>

            </div>
            <!-- Col 2 -->
            <div class="col">

                {% for ville in villes %}
                    <label>Ville : </label><br/>
                    <select name="ville-select" id="ville-select">
                        <option>{{ ville.nom }}</option>
                    </select><br/>

                    <br/>
                    <label>Lieu : </label><br/>
                    <select name="lieu-select" id="lieu-select">
                        {% for lieu in ville.lieux %}
                            <option>{{ lieu.nom }}</option>
                        {% endfor %}
                    </select><br/><br/>
                {% endfor %}

                <label>Nom :</label>
                {{ lieu.nom }}

                <label>Rue :</label>
                {{ lieu.rue }}

                {{ form_widget(form.lieu) }} <br/>
            </div>
        </div>

        <!-- Controles -->
        <button class="btn btn-success" style="border-radius:25px;">Enregistrer</button>
        <button class="btn btn-dark" style="border-radius:25px;">Publier la sortie</button>
        <button class="btn btn-danger" style="border-radius:25px;">Annuler</button>

        {{ form_end(form) }}

    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js">
        <script>
            callApi();

            function callApi() {
            var couleur_select = document.getElementById("couleurs");
            var fruit_select = document.getElementById("cocktail_Fruit");
            var couleur_id = couleur_select.value;



            let url= 'http://localhost/symfony/cocktail/public/api/couleurs/' + couleur_id;
            axios.get(url).then( response => {
// Clear
            var i, L = couleur_select.options.length - 1;
            for(i = L; i >= 0; i--) {
            fruit_select.remove(i);
        }



// Fill
            let tableau = response.data;
            for( let fruit of tableau){
            var element = document.createElement("option");
            element.textContent = fruit.nom;
            element.value = fruit.id;
            fruit_select.appendChild(element);
        }
        });
        }
    </script>
{% endblock %}
